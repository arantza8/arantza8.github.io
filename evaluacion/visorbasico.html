<!DOCTYPE html>
<html> <head>
<title>Mi primer mapa web con Leaflet </title>
<meta charset="utf-8" />

<!-- he descargado el archivo .css y he indicado la ruta relativa. He abierto el link de la presentacion y he guardado la pagina en la carpeta que tengo como directorio  -->
<link rel="stylesheet" href="./leaflet.css"
 integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
 crossorigin=""/>
<!-- he descargado el archivo .js y he indicado la ruta relativa -->
<script src="./leaflet.js"
 integrity="sha512-3Wcxp7F9bV2pl+MBgrL6Pz7AJASLpemmQPIiPA0lDs3ImF0z4JuuMIBPeirLbgIuhfH2gJyGWZjvm6M+Zr7L6Q=="
 crossorigin=""></script>

 <!-- cargar javascript (objeto GeoJSON transformado) -->
 <script src="./provincias.js"></script>

</head>

<body>
  <h1>Mapa de prueba. Joan dejame tu BlueGriffon</h1>
  Joan no sabe de qué va esta asignatura

 <!-- bloque dónde aparecerá el mapa -->
<div id="bloque_mapa" style="width: 600px; height: 400px;"></div>

<script>
// definimos el mapa como una varianble y le ajustamos dónde lo queremos ver
    var mi_mapa = L.map('bloque_mapa').setView([40, -2], 5); // L.map es la función que permite crear y manipular el mapa. Set view: coordenadas de mi mapa y nivel de zoom

// A continuación añadimos un mapa base. Crear un tile layer lleva implícito establecer la URL, el texto con la atribución y el máximo nivel de zoom de la capa
    L.tileLayer(
    // dirección de las tiles
    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw',
   // propiedades
   { maxZoom: 10,  // zoom máximo 10
    // Líneas de atribución
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' + '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
        id: 'mapbox.streets'
    }).addTo(mi_mapa);

    var marker = L.marker([40, -4]  // marcador en esas coordenadas
      ).addTo(mi_mapa);               // se añade al mapa

      // // añadimos círculo
      //   var circle = L.circle(      // variable círculo en esas coordenadas
      //     [41, -1], {               // coordenadas del centro
      //     color: 'purple',             // estilo color
      //     fillColor: 'white',        //        color de relleno
      //     fillOpacity: 0.5,         //        opacidad del relleno
      //     radius: 200000            //        radio: 300Km
      //     }).addTo(mi_mapa);        // se añade al mapa
      //
      //     // añadimos polígono
      //       var polygon = L.polygon([   // variable polígono
      //           [39, -3], // coordenadas de los vértices
      //           [43, -3],
      //           [46, -2],
      //           [42, 6],
      //           [40, 3],
      //           [39, 0]
      //       ], {color: 'yellow',             // estilo color
      //       fillColor: 'blue',        // color de relleno
      //       fillOpacity: 0.0          // opacidad
      //     }); polygon.addTo(mi_mapa)     // se puede añadir aplicando función al objeto (mejor hacerlo como antes)

          // para subir a github: en la esquina inferior dcha, donde pone Git() vemos los cambios que ha habido. Le damos a Stage All y luego Commit

          // Cambiamos capa base. AÑADIMOS CAPA TMS
          var stamen_tms = L.tileLayer(
  'http://a.tile.stamen.com/terrain/{z}/{x}/{y}.png', { // URL con tiles
      // texto de atribución - IMPORTANTE
      attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>,<a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash;Map data: &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>contributors,<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
      maxZoom: 20  // zoom máximo
      });
  stamen_tms.addTo(mi_mapa);


  // Cambiamos mapa base. Añadir TM de OpenStreetMap render Mapnik
var OSM_mapnik = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});
  OSM_mapnik.addTo(mi_mapa);


// Más capas de tiles: https://leaflet-extras.github.io/leaflet-providers/preview/

// Añadimos un WMS (PNOA)
var PNOA = L.tileLayer.wms('http://www.idee.es/wms/PNOA/PNOA?', {  //URL WMS
      layers: 'PNOA',          // capa del WMS
      format: 'image/png',     // tipo de formato
      transparent: true,       // activa capa alfa/transparente
      });
  PNOA.addTo(mi_mapa);         // añadir capa al mapa

//INCLUIR CONTROLES. Así podemos seleccionar capas, modificarlas...
//Primero definimos las variables que van a ir dentro de control layers
// Hay dos tipos de capas: base (se elige una u otra) y superpuestas (se activan o desactivan)
  var baseMaps = {                  // variable con apartado de mapas base
      "OpenStreetMap": OSM_mapnik,  // elemento a incluir y descripción (entre comillas)
      "Stamen": stamen_tms,
      };
  var overlayMaps = {              // apartado de capas
      "Ortofoto PNOA": PNOA       // elemento a incluir y descripción
      };
  var capas = L.control.layers(   // variable con control de capas
    baseMaps,                     // añadiendo capas base
    overlayMaps,                  // añadiendo capas
    {collapsed:true});            // control NO desplegado
  capas.addTo(mi_mapa);           // añadimos control de capas al mapa

  var escala = L.control.scale({position: "topleft"}
    )
    escala.addTo(mi_mapa);

  // Ahora en la esquina superior derecha nos sale un desplegable en el que podemos seleccionar como base la capa Stamen o la de OpenStreetMap y podemos activar y desactivar el pnoa

//JSON: sistema propio de java script para añadir objetos. El archivo JSON hay que pasarlo a una variable

    // añadir capa GeoJSON
    var araprov = L.geoJSON( // crear objeto araprov como capa geojson
      araprov, {             // código a cargar: `araprov`, que es el ojeto creado con la capa json
      color: 'red',             // estilo color
      fillColor: 'blue',        //   color de relleno
      fillOpacity: 0.2,         //  opacidad de relleno
      });

    araprov.addTo(mi_mapa)   //


</script>

<!-- cargar javascript (objeto GeoJSON transformado) -->
<script src="./provinciasgeojson.js"></script>

</body>
